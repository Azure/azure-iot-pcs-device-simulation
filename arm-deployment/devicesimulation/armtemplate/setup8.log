
--2019-06-15 00:19:57--  https://raw.githubusercontent.com/Azure/pcs-cli/pfelts/change-vm-update-process/solutions/devicesimulation/single-vm/setup.sh
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.8.133
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.8.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 15456 (15K) [text/plain]
Saving to: ‘setup.sh’

     0K .......... .....                                      100% 18.4M=0.001s

2019-06-15 00:19:57 (18.4 MB/s) - ‘setup.sh’ saved [15456/15456]

+ APP_PATH=/app
+ WEBUICONFIG=/app/webui-config.js
+ WEBUICONFIG_SAFE=/app/webui-config.js.safe
+ WEBUICONFIG_UNSAFE=/app/webui-config.js.unsafe
+ ENVVARS=/app/env-vars
+ DOCKERCOMPOSE=/app/docker-compose.yml
+ CERTS=/app/certs
+ CERT=/app/certs/tls.crt
+ PKEY=/app/certs/tls.key
+ export HOST_NAME=localhost
+ HOST_NAME=localhost
+ export PCS_LOG_LEVEL=Info
+ PCS_LOG_LEVEL=Info
+ export PCS_WEBUI_AUTH_TYPE=aad
+ PCS_WEBUI_AUTH_TYPE=aad
+ export PCS_IOTHUB_CONNSTRING=
+ PCS_IOTHUB_CONNSTRING=
+ '[' 66 -gt 0 ']'
+ case "$1" in
+ PCS_LOG_LEVEL=Info
+ shift
+ '[' 65 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 64 -gt 0 ']'
+ case "$1" in
+ HOST_NAME=pfelt-jy3.southeastasia.cloudapp.azure.com
+ shift
+ '[' 63 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 62 -gt 0 ']'
+ case "$1" in
+ PCS_RESOURCE_GROUP_LOCATION=southeastasia
+ shift
+ '[' 61 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 60 -gt 0 ']'
+ case "$1" in
+ PCS_VMSS_NAME=pfelt-jy3
+ shift
+ '[' 59 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 58 -gt 0 ']'
+ case "$1" in
+ PCS_STORAGEADAPTER_DOCUMENTDB_CONNSTRING='AccountEndpoint=https://documentdb-jy3im.documents.azure.com:443/;AccountKey=lbs9tukUf7HwGp1OmpLNaOnOkPq4hFIMfvE3KrnPHnGL79NqFxSHNNTY3PBvkRFcP1FrDTtGwXWCQkQeS8TmNg==;'
+ shift
+ '[' 57 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 56 -gt 0 ']'
+ case "$1" in
+ PCS_CERTIFICATE='-----BEGIN CERTIFICATE-----
MIICeTCCAWGgAwIBAgIBATANBgkqhkiG9w0BAQUFADAAMB4XDTE5MDYxNTAwMTMz
NloXDTIwMDYxNTAwMTMzNlowADCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC
ggEBAJH14IBBZlj4yqbTEEa2+tjsVq3ow2Qruw/Md4Ze7/Kml4dVE8eir89NQi8u
OAHa1VKac/WONGk8ZDmIXSsB0pNxPvb63pS/9ojhWMjCq4XXDMl34XckU7om7fyN
vKuxfNocr7NuO8SbQ8zOLBkZFDcH1LCoc6n9wPdEdGZM8YYld3v+874Dikjp4BfP
Bklaasr7274GHftV8VESHONYH3M8Z8g+gFt9U5F95zi+J2es1chxhbEBrjujN5rK
ZVdJs40ech/CJMpnDobKW1EQLS119G7cR6NihKYjxmjHfpk+V0oRK/7j3b8gRdfI
VrGdcFNkEfcMVbHsfZyMg+XEt00CAwEAATANBgkqhkiG9w0BAQUFAAOCAQEAg1qr
UuiX8gMCMZohlTU78TF3sK8sk2MV+Qnb9AupZ9azq9IlabVhHEWsAKBnWQW2YqpH
zj4KJQz15/FGi69idM1qQRq1/BjGlHWQkt5tVi+xNNeM7DKUE5F/GcIlziXuMAgV
1ien/gqIrb1r2ul7B4CYlpymAqzkix6inZTChWRntD0cV+3dn0BSnlLmHaAifV+Z
NlKv/MNhtnujod2XU1uUHxnjXl43fwi37ByfD6gaUpMKtdPwsqJIYQOraw4Se7MY
7K0bXv68BomT2xPMn2M6CvSP8YpmI2WAoi6oymAzPd7fGZhNQFGkR9HrB/pIayqw
jOI9wzBWKtFXpY87kg==
-----END CERTIFICATE-----
'
+ shift
+ '[' 55 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 54 -gt 0 ']'
+ case "$1" in
+ PCS_CERTIFICATE_KEY='-----BEGIN RSA PRIVATE KEY-----
MIIEoAIBAAKCAQEAkfXggEFmWPjKptMQRrb62OxWrejDZCu7D8x3hl7v8qaXh1UT
x6Kvz01CLy44AdrVUppz9Y40aTxkOYhdKwHSk3E+9vrelL/2iOFYyMKrhdcMyXfh
dyRTuibt/I28q7F82hyvs247xJtDzM4sGRkUNwfUsKhzqf3A90R0ZkzxhiV3e/7z
vgOKSOngF88GSVpqyvvbvgYd+1XxURIc41gfczxnyD6AW31TkX3nOL4nZ6zVyHGF
sQGuO6M3msplV0mzjR5yH8IkymcOhspbURAtLXX0btxHo2KEpiPGaMd+mT5XShEr
/uPdvyBF18hWsZ1wU2QR9wxVsex9nIyD5cS3TQIDAQABAoIBAF7kWksnuZFYVe+1
Qlym81h59jRkIjuKjrfLt109dYPsuJC8R/q/EsuUL9Yal0Dlc1Cbp43aIMrV/1bE
B8ZBDhTbSBMrr+9HCdGdp6oFnZuK3v5QGN3rWR+p1Yke4K1C26e1hKkDnonIY4DP
/S1n95N7XNRo/6FhnsVi1MX5egA6eZDVLNHQKbH1pOhI0/2JqByY/vPEhgB5o283
J4GE0Q//f8yTWaD11lyXs3Weolv0LzYYhaF0jyVlMStYp8FfJBWPcs0Gp8u5WaRe
m67gmMWRQnGkBf7dcm4cAv0SOGS9LW2CZHANOI8goweAAY1JShRcL5fm7GorZsGx
sv2JYIUCgYEAzvOoysu2da03pWa6GtQ0iQuxr5AT0+74nvJ9MesflO1KqfhYMWNK
hrpYZDPT43lt6Wsy6LacW6mwQtRtmtbDSs6ZvkIeiF+B32ZpEf1rSKOaWHtLNpD8
el1uOUsl5MaHaxKZjess8Fyg3puT++CufgmGLv37rP6p5S2o9HN/8ycCgYEAtI20
IJ/65oj3Smd00wBPikmSjXBcR2L3PtxuH46fCnw7ObX/HCSAaKRHbc017FxUFwQl
yDiA5cIat2PIngDv7pbUZVhaGvPFk+OagQ7JQG4WOiKfJYTl5zi+ASS86Yr2+7nq
sNOZ18timqLgOYu91/Swpk44FAWSAkni7OM6+msCfyLCypdFoGAjuDUQDDJ1cl2S
mUXj7XCrsxb/pAe+do+NS/1AuY+SHfKDWlV6XxzWSJ/sYaC1C45Z8kFHbSGU8Tif
ezN556cAY9AiY4OiDWMmF8bE7t07fS0QhHMbLEJBFn3loeU0m1fEN0Es4K5uDuEc
uG0sPBnSrLbR9I8a12MCgYBAc/FgUBu93hkA+4uNoyfBwt/JE9otNZvzWbcKFtyZ
Xp25zUlDX5hjQnmpLb9ZH+B40uc14U3KNw9Ydgtws/7yme86Ol74Dhty3qYR+hhH
osTWffN37kgv0Waqe9XgPNZMKCMqem8JxLXvY8NNZ6Aejl/dDkEgjJiBrqSOUdOE
/wKBgE4o910SYp6yrW8j0XgwmtAJZPnJwxekN40LyJTBAdLttIvbjBpMV3JK9jgt
xa9srX6z8/iTCfy2VbhTlPVI0xdcArL5Bc/rGBp0vToZzmSbRpKhd2EuM5HwUKUh
bhv43mMf74hHRmMeHDkRsQz+UgA38KcJNLtuTvEQMN1UxGZ8
-----END RSA PRIVATE KEY-----
'
+ shift
+ '[' 53 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 52 -gt 0 ']'
+ case "$1" in
+ PCS_WEBUI_AUTH_TYPE=aad
+ shift
+ '[' 51 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 50 -gt 0 ']'
+ case "$1" in
+ PCS_AUTH_AUDIENCE=5fc08593-2496-419e-a60e-d0ed869e8255
+ shift
+ '[' 49 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 48 -gt 0 ']'
+ case "$1" in
+ PCS_WEBUI_AUTH_AAD_APPID=5fc08593-2496-419e-a60e-d0ed869e8255
+ shift
+ '[' 47 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 46 -gt 0 ']'
+ case "$1" in
+ PCS_WEBUI_AUTH_AAD_TENANT=72f988bf-86f1-41af-91ab-2d7cd011db47
+ shift
+ '[' 45 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 44 -gt 0 ']'
+ case "$1" in
+ PCS_AUTH_ISSUER=https://sts.windows.net/72f988bf-86f1-41af-91ab-2d7cd011db47/
+ shift
+ '[' 43 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 42 -gt 0 ']'
+ case "$1" in
+ PCS_WEBUI_AUTH_AAD_INSTANCE=https://login.microsoftonline.com/
+ shift
+ '[' 41 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 40 -gt 0 ']'
+ case "$1" in
+ PCS_RESOURCE_GROUP=pfelts06-14-2019-08
+ shift
+ '[' 39 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 38 -gt 0 ']'
+ case "$1" in
+ PCS_RELEASE_VERSION=pfelts/change-vm-update-process
+ shift
+ '[' 37 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 36 -gt 0 ']'
+ case "$1" in
+ PCS_SOLUTION_TYPE=DeviceSimulation
+ shift
+ '[' 35 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 34 -gt 0 ']'
+ case "$1" in
+ PCS_DEPLOYMENT_ID=0cc6cca3-bc16-4085-a34d-f15d4ad727b1
+ shift
+ '[' 33 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 32 -gt 0 ']'
+ case "$1" in
+ PCS_AZURE_STORAGE_ACCOUNT='DefaultEndpointsProtocol=https;AccountName=storagejy3im;AccountKey=lbTKdnQl7N9ZZsF+e1tVp55JmPJIyfBkC55pE6hqXVtpA8i6ACqANMO8A2kt4+uIy7apuyRq7GJjhHdrd1ctBg=='
+ shift
+ '[' 31 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 30 -gt 0 ']'
+ case "$1" in
+ PCS_DOCDB_NAME=documentdb-jy3im
+ shift
+ '[' 29 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 28 -gt 0 ']'
+ case "$1" in
+ PCS_SOLUTION_NAME=pfelts06-14-2019-08
+ shift
+ '[' 27 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 26 -gt 0 ']'
+ case "$1" in
+ PCS_SOLUTION_SETUP_URL=https://raw.githubusercontent.com/Azure/pcs-cli/pfelts/change-vm-update-process/solutions/devicesimulation
+ shift
+ '[' 25 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 24 -gt 0 ']'
+ case "$1" in
+ PCS_DOCKER_TAG=DS-2.0.4
+ shift
+ '[' 23 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 22 -gt 0 ']'
+ case "$1" in
+ PCS_SUBSCRIPTION_DOMAIN=microsoft.onmicrosoft.com
+ shift
+ '[' 21 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 20 -gt 0 ']'
+ case "$1" in
+ PCS_SUBSCRIPTION_ID=4989c672-dacb-431a-b9af-ae30e1c09b41
+ shift
+ '[' 19 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 18 -gt 0 ']'
+ case "$1" in
+ PCS_AAD_CLIENT_SP_ID=5fc08593-2496-419e-a60e-d0ed869e8255
+ shift
+ '[' 17 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 16 -gt 0 ']'
+ case "$1" in
+ PCS_AAD_SECRET='G6!zzoafqsjyanhgcwzr'
+ shift
+ '[' 15 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 14 -gt 0 ']'
+ case "$1" in
+ PCS_IOHUB_NAME=iothub-jy3im
+ shift
+ '[' 13 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 12 -gt 0 ']'
+ case "$1" in
+ PCS_IOTHUB_SKU=S2
+ shift
+ '[' 11 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 10 -gt 0 ']'
+ case "$1" in
+ PCS_IOTHUB_TIER=Standard
+ shift
+ '[' 9 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 8 -gt 0 ']'
+ case "$1" in
+ PCS_IOTHUB_UNITS=1
+ shift
+ '[' 7 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 6 -gt 0 ']'
+ case "$1" in
+ PCS_IOTHUB_CONNSTRING='HostName=iothub-jy3im.azure-devices.net;SharedAccessKeyName=iothubowner;SharedAccessKey=Zwz2mSbDCnMRF8CfG4/L4r1It+Vu5GnADs1Tkt0m6IY='
+ shift
+ '[' 5 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 4 -gt 0 ']'
+ case "$1" in
+ PCS_CLOUD_TYPE=Global
+ shift
+ '[' 3 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 2 -gt 0 ']'
+ case "$1" in
+ PCS_APPINSIGHTS_INSTRUMENTATIONKEY=eb999fc6-bd22-4d7d-b81f-c91ec4cb1346
+ shift
+ '[' 1 -gt 0 ']'
+ case "$1" in
+ shift
+ '[' 0 -gt 0 ']'
+ '[' -z https://raw.githubusercontent.com/Azure/pcs-cli/pfelts/change-vm-update-process/solutions/devicesimulation ']'
+ '[' -z pfelts/change-vm-update-process ']'
+ REPOSITORY=https://raw.githubusercontent.com/Azure/pcs-cli/pfelts/change-vm-update-process/solutions/devicesimulation/single-vm
+ SCRIPTS_URL=https://raw.githubusercontent.com/Azure/pcs-cli/pfelts/change-vm-update-process/solutions/devicesimulation/single-vm/scripts/
+ SETUP_URL=https://raw.githubusercontent.com/Azure/pcs-cli/pfelts/change-vm-update-process/solutions/devicesimulation/single-vm/setup/
+ set +e
+ INSTALL_DOCKER_RESULT=OK
+ install_docker_ce
+ apt-get update -o Acquire::CompressionTypes::Order::=gz
Get:1 http://security.ubuntu.com/ubuntu bionic-security InRelease [88.7 kB]
Hit:2 http://archive.ubuntu.com/ubuntu bionic InRelease
Get:3 http://archive.ubuntu.com/ubuntu bionic-updates InRelease [88.7 kB]
Get:4 http://security.ubuntu.com/ubuntu bionic-security/main amd64 Packages [535 kB]
Hit:5 http://archive.ubuntu.com/ubuntu bionic-backports InRelease
Err:5 http://archive.ubuntu.com/ubuntu bionic-backports InRelease
  Splitting up /var/lib/apt/lists/archive.ubuntu.com_ubuntu_dists_bionic-backports_InRelease into data and signature failed
Get:6 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 Packages [837 kB]
Get:7 http://security.ubuntu.com/ubuntu bionic-security/main Translation-en [207 kB]
Get:8 http://security.ubuntu.com/ubuntu bionic-security/universe amd64 Packages [717 kB]
Get:9 http://security.ubuntu.com/ubuntu bionic-security/universe Translation-en [254 kB]
Get:10 http://security.ubuntu.com/ubuntu bionic-security/multiverse amd64 Packages [4169 B]
Get:11 http://archive.ubuntu.com/ubuntu bionic-updates/main Translation-en [338 kB]
Get:12 http://archive.ubuntu.com/ubuntu bionic-updates/restricted amd64 Packages [10.8 kB]
Get:13 http://archive.ubuntu.com/ubuntu bionic-updates/restricted Translation-en [3089 B]
Get:14 http://archive.ubuntu.com/ubuntu bionic-updates/universe amd64 Packages [1220 kB]
Get:15 http://archive.ubuntu.com/ubuntu bionic-updates/universe Translation-en [394 kB]
Get:16 http://archive.ubuntu.com/ubuntu bionic-updates/multiverse amd64 Packages [7239 B]
Get:17 http://archive.ubuntu.com/ubuntu bionic-updates/multiverse Translation-en [3607 B]
Reading package lists...
W: GPG error: http://archive.ubuntu.com/ubuntu bionic-backports InRelease: Splitting up /var/lib/apt/lists/archive.ubuntu.com_ubuntu_dists_bionic-backports_InRelease into data and signature failed
E: The repository 'http://archive.ubuntu.com/ubuntu bionic-backports InRelease' is not signed.
+ local RESULT=100
+ '[' 100 -ne 0 ']'
+ INSTALL_DOCKER_RESULT=FAIL
+ '[' FAIL '!=' OK ']'
+ set -e
+ echo 'Error: first attempt to install Docker failed, retrying...'
Error: first attempt to install Docker failed, retrying...
+ sleep 120
+ install_docker_ce
+ apt-get update -o Acquire::CompressionTypes::Order::=gz
Hit:1 http://security.ubuntu.com/ubuntu bionic-security InRelease
Hit:2 http://azure.archive.ubuntu.com/ubuntu bionic InRelease
Get:3 http://azure.archive.ubuntu.com/ubuntu bionic-updates InRelease [88.7 kB]
Hit:4 http://azure.archive.ubuntu.com/ubuntu bionic-backports InRelease
Get:5 http://azure.archive.ubuntu.com/ubuntu bionic-updates/main amd64 Packages [837 kB]
Get:6 http://azure.archive.ubuntu.com/ubuntu bionic-updates/main Translation-en [338 kB]
Get:7 http://azure.archive.ubuntu.com/ubuntu bionic-updates/universe amd64 Packages [1220 kB]
Get:8 http://azure.archive.ubuntu.com/ubuntu bionic-updates/universe Translation-en [394 kB]
Get:9 http://azure.archive.ubuntu.com/ubuntu bionic-updates/multiverse amd64 Packages [7239 B]
Fetched 2884 kB in 1s (3091 kB/s)
Reading package lists...
+ apt-get remove docker docker-engine docker.io
Reading package lists...
Building dependency tree...
Reading state information...
Package 'docker-engine' is not installed, so not removed
Package 'docker' is not installed, so not removed
Package 'docker.io' is not installed, so not removed
0 upgraded, 0 newly installed, 0 to remove and 48 not upgraded.
+ apt-get -y --allow-downgrades --allow-remove-essential --allow-change-held-packages --no-install-recommends install apt-transport-https ca-certificates curl gnupg2 software-properties-common
Reading package lists...
Building dependency tree...
Reading state information...
ca-certificates is already the newest version (20180409).
ca-certificates set to manually installed.
curl is already the newest version (7.58.0-2ubuntu3.7).
curl set to manually installed.
software-properties-common is already the newest version (0.96.24.32.9).
software-properties-common set to manually installed.
The following NEW packages will be installed:
  apt-transport-https gnupg2
0 upgraded, 2 newly installed, 0 to remove and 48 not upgraded.
Need to get 6360 B of archives.
After this operation, 205 kB of additional disk space will be used.
Get:1 http://azure.archive.ubuntu.com/ubuntu bionic-updates/universe amd64 apt-transport-https all 1.6.11 [1692 B]
Get:2 http://azure.archive.ubuntu.com/ubuntu bionic-updates/universe amd64 gnupg2 all 2.2.4-1ubuntu1.2 [4668 B]
debconf: unable to initialize frontend: Dialog
debconf: (TERM is not set, so the dialog frontend is not usable.)
debconf: falling back to frontend: Readline
debconf: unable to initialize frontend: Readline
debconf: (This frontend requires a controlling tty.)
debconf: falling back to frontend: Teletype
dpkg-preconfigure: unable to re-open stdin: 
Fetched 6360 B in 0s (0 B/s)
Selecting previously unselected package apt-transport-https.
(Reading database ... (Reading database ... 5%(Reading database ... 10%(Reading database ... 15%(Reading database ... 20%(Reading database ... 25%(Reading database ... 30%(Reading database ... 35%(Reading database ... 40%(Reading database ... 45%(Reading database ... 50%(Reading database ... 55%(Reading database ... 60%(Reading database ... 65%(Reading database ... 70%(Reading database ... 75%(Reading database ... 80%(Reading database ... 85%(Reading database ... 90%(Reading database ... 95%(Reading database ... 100%(Reading database ... 55679 files and directories currently installed.)
Preparing to unpack .../apt-transport-https_1.6.11_all.deb ...
Unpacking apt-transport-https (1.6.11) ...
Selecting previously unselected package gnupg2.
Preparing to unpack .../gnupg2_2.2.4-1ubuntu1.2_all.deb ...
Unpacking gnupg2 (2.2.4-1ubuntu1.2) ...
Setting up apt-transport-https (1.6.11) ...
Setting up gnupg2 (2.2.4-1ubuntu1.2) ...
Processing triggers for man-db (2.8.3-2ubuntu0.1) ...
+ sudo apt-key add -
++ . /etc/os-release
+++ NAME=Ubuntu
+++ VERSION='18.04.2 LTS (Bionic Beaver)'
+++ ID=ubuntu
+++ ID_LIKE=debian
+++ PRETTY_NAME='Ubuntu 18.04.2 LTS'
+++ VERSION_ID=18.04
+++ HOME_URL=https://www.ubuntu.com/
+++ SUPPORT_URL=https://help.ubuntu.com/
+++ BUG_REPORT_URL=https://bugs.launchpad.net/ubuntu/
+++ PRIVACY_POLICY_URL=https://www.ubuntu.com/legal/terms-and-policies/privacy-policy
+++ VERSION_CODENAME=bionic
+++ UBUNTU_CODENAME=bionic
++ echo ubuntu
+ curl -fsSL https://download.docker.com/linux/ubuntu/gpg
Warning: apt-key output should not be parsed (stdout is not a terminal)
OK
++ . /etc/os-release
+++ NAME=Ubuntu
+++ VERSION='18.04.2 LTS (Bionic Beaver)'
+++ ID=ubuntu
+++ ID_LIKE=debian
+++ PRETTY_NAME='Ubuntu 18.04.2 LTS'
+++ VERSION_ID=18.04
+++ HOME_URL=https://www.ubuntu.com/
+++ SUPPORT_URL=https://help.ubuntu.com/
+++ BUG_REPORT_URL=https://bugs.launchpad.net/ubuntu/
+++ PRIVACY_POLICY_URL=https://www.ubuntu.com/legal/terms-and-policies/privacy-policy
+++ VERSION_CODENAME=bionic
+++ UBUNTU_CODENAME=bionic
++ echo ubuntu
++ lsb_release -cs
+ add-apt-repository 'deb [arch=amd64] https://download.docker.com/linux/ubuntu bionic stable'
Hit:1 http://azure.archive.ubuntu.com/ubuntu bionic InRelease
Hit:2 http://azure.archive.ubuntu.com/ubuntu bionic-updates InRelease
Hit:3 http://azure.archive.ubuntu.com/ubuntu bionic-backports InRelease
Get:4 https://download.docker.com/linux/ubuntu bionic InRelease [64.4 kB]
Hit:5 http://security.ubuntu.com/ubuntu bionic-security InRelease
Get:6 https://download.docker.com/linux/ubuntu bionic/stable amd64 Packages [6426 B]
Fetched 70.9 kB in 1s (126 kB/s)
Reading package lists...
+ apt-get update
Hit:1 http://azure.archive.ubuntu.com/ubuntu bionic InRelease
Hit:2 http://azure.archive.ubuntu.com/ubuntu bionic-updates InRelease
Hit:3 http://azure.archive.ubuntu.com/ubuntu bionic-backports InRelease
Hit:4 https://download.docker.com/linux/ubuntu bionic InRelease
Hit:5 http://security.ubuntu.com/ubuntu bionic-security InRelease
Reading package lists...
+ apt-get --force-yes --allow-downgrades install docker-ce docker-compose
Reading package lists...
Building dependency tree...
Reading state information...
The following additional packages will be installed:
  aufs-tools cgroupfs-mount containerd.io docker-ce-cli
  golang-docker-credential-helpers libltdl7 libsecret-1-0 libsecret-common
  libssl1.1 pigz python-asn1crypto python-backports.ssl-match-hostname
  python-cached-property python-certifi python-cffi-backend python-chardet
  python-cryptography python-docker python-dockerpty python-dockerpycreds
  python-docopt python-enum34 python-funcsigs python-functools32 python-idna
  python-ipaddress python-jsonschema python-mock python-openssl python-pbr
  python-pkg-resources python-requests python-six python-texttable
  python-urllib3 python-websocket python-yaml
Suggested packages:
  python-cryptography-doc python-cryptography-vectors python-enum34-doc
  python-funcsigs-doc python-mock-doc python-openssl-doc python-openssl-dbg
  python-setuptools python-socks python-ntlm
Recommended packages:
  docker.io
The following NEW packages will be installed:
  aufs-tools cgroupfs-mount containerd.io docker-ce docker-ce-cli
  docker-compose golang-docker-credential-helpers libltdl7 libsecret-1-0
  libsecret-common pigz python-asn1crypto python-backports.ssl-match-hostname
  python-cached-property python-certifi python-cffi-backend python-chardet
  python-cryptography python-docker python-dockerpty python-dockerpycreds
  python-docopt python-enum34 python-funcsigs python-functools32 python-idna
  python-ipaddress python-jsonschema python-mock python-openssl python-pbr
  python-pkg-resources python-requests python-six python-texttable
  python-urllib3 python-websocket python-yaml
The following packages will be upgraded:
  libssl1.1
1 upgraded, 38 newly installed, 0 to remove and 47 not upgraded.
Need to get 54.1 MB of archives.
After this operation, 254 MB of additional disk space will be used.
W: --force-yes is deprecated, use one of the options starting with --allow instead.
Do you want to continue? [Y/n] Abort.
+ local RESULT=1
+ '[' 1 -ne 0 ']'
+ INSTALL_DOCKER_RESULT=FAIL
+ '[' FAIL '!=' OK ']'
+ echo 'Error: Docker installation failed'
Error: Docker installation failed
+ exit 1
